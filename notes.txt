"sudo apt-get update && sudo apt-get -y install debconf-i18n && DEBIAN_FRONTEND=noninteractive | apt-get install -y mysql-server && sudo mysql --defaults-file=/etc/mysql/debian.cnf -e "DELETE FROM mysql.user WHERE User='root' AND Host NOT IN ('localhost', '127.0.0.1', '::1');" && sudo mysql --defaults-file=/etc/mysql/debian.cnf -e "DELETE FROM mysql.user WHERE User='';" && sudo mysql --defaults-file=/etc/mysql/debian.cnf -e "DELETE FROM mysql.db WHERE Db='test' OR Db='test\\_localhost';" && sudo mysql --defaults-file=/etc/mysql/debian.cnf -e "FLUSH PRIVILEGES;" && sudo sed -i "s/.*bind-address.*/bind-address = 0.0.0.0/" /etc/mysql/mysql.conf.d/mysqld.cnf && sudo systemctl restart mysql && sudo mysql --defaults-file=/etc/mysql/debian.cnf -e "CREATE DATABASE Demo;" && sudo mysql --defaults-file=/etc/mysql/debian.cnf -e "CREATE USER 'demouser'@'%' IDENTIFIED BY 'paloalto@123';" && sudo mysql --defaults-file=/etc/mysql/debian.cnf -e "GRANT ALL PRIVILEGES ON Demo.* TO 'demouser'@'%';" && sudo mysql --defaults-file=/etc/mysql/debian.cnf -e "FLUSH PRIVILEGES;""


sudo apt-get update 
 sudo apt-get -y install debconf-i18n 
 DEBIAN_FRONTEND=noninteractive | apt-get install -y mysql-server 
 sudo mysql --defaults-file=/etc/mysql/debian.cnf -e "DELETE FROM mysql.user WHERE User='root' AND Host NOT IN ('localhost', '127.0.0.1', '::1');" 
 sudo mysql --defaults-file=/etc/mysql/debian.cnf -e "DELETE FROM mysql.user WHERE User='';" 
 sudo mysql --defaults-file=/etc/mysql/debian.cnf -e "DELETE FROM mysql.db WHERE Db='test' OR Db='test_localhost';" 
 sudo mysql --defaults-file=/etc/mysql/debian.cnf -e "FLUSH PRIVILEGES;" 
 sudo sed -i "s/.*bind-address.*/bind-address = 0.0.0.0/" /etc/mysql/mysql.conf.d/mysqld.cnf 
 sudo systemctl restart mysql 
 sudo mysql --defaults-file=/etc/mysql/debian.cnf -e "CREATE DATABASE Demo;" 
 sudo mysql --defaults-file=/etc/mysql/debian.cnf -e "CREATE USER 'demouser'@'%' IDENTIFIED BY 'paloalto@123';" 
 sudo mysql --defaults-file=/etc/mysql/debian.cnf -e "GRANT ALL PRIVILEGES ON Demo.* TO 'demouser'@'%';" 
 sudo mysql --defaults-file=/etc/mysql/debian.cnf -e "FLUSH PRIVILEGES;""


 https://jjmdevday.s3-us-west-2.amazonaws.com/cft/CentralizedArchitecturePrimary.yaml


 aws ec2 describe-images --owners amazon --filters "Name=name,Values=Bionic*" --query 'sort_by(Images, &CreationDate)[].Name'

 Get-SSMParametersByPath -Path "/aws/service/canonical" -region us-west-2

 aws ssm get-parameters-by-path --path "/aws/service/canonical" --region us-west-1


until resp=$(curl -s -S -g --max-time 3 --insecure "http://neverssl.com");do
if [[ $resp == *"[CDATA[success"* ]] ; then
    echo "found"
    break
  fi
  echo "not found"
  sleep 10s
done  


#!/bin/bash
#until $(curl -s -S -g --max-time 3 --insecure "http://neverssl.com");do
until $(curl --output /dev/null --silent --head --fail "http://neverssl.com"); do
   sleep 10s
done
sudo apt-get update && sudo apt-get -y install debconf-i18n && DEBIAN_FRONTEND=noninteractive | apt-get install -y mysql-server && sudo mysql --defaults-file=/etc/mysql/debian.cnf -e "DELETE FROM mysql.user WHERE User='root' AND Host NOT IN ('localhost', '127.0.0.1', '::1');" && sudo mysql --defaults-file=/etc/mysql/debian.cnf -e "DELETE FROM mysql.user WHERE User='';" && sudo mysql --defaults-file=/etc/mysql/debian.cnf -e "DELETE FROM mysql.db WHERE Db='test' OR Db='test\\_localhost';" && sudo mysql --defaults-file=/etc/mysql/debian.cnf -e "FLUSH PRIVILEGES;" && sudo sed -i "s/.*bind-address.*/bind-address = 0.0.0.0/" /etc/mysql/mysql.conf.d/mysqld.cnf && sudo systemctl restart mysql && sudo mysql --defaults-file=/etc/mysql/debian.cnf -e "CREATE DATABASE Demo;" && sudo mysql --defaults-file=/etc/mysql/debian.cnf -e "CREATE USER 'demouser'@'%' IDENTIFIED BY 'paloalto@123';" && sudo mysql --defaults-file=/etc/mysql/debian.cnf -e "GRANT ALL PRIVILEGES ON Demo.* TO 'demouser'@'%';" && sudo mysql --defaults-file=/etc/mysql/debian.cnf -e "FLUSH PRIVILEGES;"


aws cloudformation create-stack --stack-name web10 --template-url https://jjmdevday.s3-us-west-2.amazonaws.com/cft/CentralizedArchitecturePrimary.yaml --capabilities CAPABILITY_IAM


aws s3 cp /home/ubuntu/environment/devdaygwlb s3://jjmdevday/cft --recursive  --exclude "*" --include "*.yaml"
